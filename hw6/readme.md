# 操作系统 作业 6

宋婉婷 2022K8009929009

## 6.1 银行家算法

某系统存在 4 个进程和 5 份可分配资源，当前的资源分配情况和最大需求如下表所示。求满足安全状态下 X 的最小值。请写出解题分析过程。

![1](F:\oslab25\myhomework\hw6\task1.png)

**答：** 列出进程需要的资源数如图：

|           | allocated | maximum     | require   | available |
| --------- | --------- | ----------- | --------- | --------- |
| process A | 5 4 2 5 3 | 5 5 2 5 5   | 0 1 0 0 2 | 0 x 1 0 0 |
| process B | 3 1 3 2 5 | 3 3 4 2 5   | 0 2 1 0 0 |           |
| process C | 2 0 3 4 1 | 6 0 6 4 1   | 4 0 3 0 0 |           |
| process D | 4 2 3 5 2 | 10 2 4 5 11 | 6 0 1 0 9 |           |

则若想开始分配，x 必须先大于等于 2 。假设 $x=2$，则先分配给进程 B，运行结束后回收资源如下：

|           | allocated | maximum     | require   | available |
| --------- | --------- | ----------- | --------- | --------- |
| process A | 5 4 2 5 3 | 5 5 2 5 5   | 0 1 0 0 2 | 3 3 4 2 5 |
| process B | 0 0 0 0 0 | 3 3 4 2 5   | 0 0 0 0 0 |           |
| process C | 2 0 3 4 1 | 6 0 6 4 1   | 4 0 3 0 0 |           |
| process D | 4 2 3 5 2 | 10 2 4 5 11 | 6 0 1 0 9 |           |

接着分配给 A，运行结束后回收资源如下：

|           | allocated | maximum     | require   | available |
| --------- | --------- | ----------- | --------- | --------- |
| process A | 0 0 0 0 0 | 5 5 2 5 5   | 0 0 0 0 0 | 8 7 6 7 8 |
| process B | 0 0 0 0 0 | 3 3 4 2 5   | 0 0 0 0 0 |           |
| process C | 2 0 3 4 1 | 6 0 6 4 1   | 4 0 3 0 0 |           |
| process D | 4 2 3 5 2 | 10 2 4 5 11 | 6 0 1 0 9 |           |

接着分配给 C：

|           | allocated | maximum     | require   | available   |
| --------- | --------- | ----------- | --------- | ----------- |
| process A | 0 0 0 0 0 | 5 5 2 5 5   | 0 0 0 0 0 | 10 7 9 11 9 |
| process B | 0 0 0 0 0 | 3 3 4 2 5   | 0 0 0 0 0 |             |
| process C | 0 0 0 0 0 | 6 0 6 4 1   | 0 0 0 0 0 |             |
| process D | 4 2 3 5 2 | 10 2 4 5 11 | 6 0 1 0 9 |             |

此时可以分配给 D，因此进程调度可实现。则满足安全状态下 x 最小值为 2 。

## 6.2 死锁分析

两进程 A 和 B 各需要数据库中的 3 份记录 1、2、3，若进程 A 以 1、2、3 的顺序请求这些资源， 进程 B 也以同样的顺序请求这些资源，则不会产生死锁。但若进程 B 以 3、2、1 的顺序请求这些资源，则可能会产生死锁。这 3 份资源存在 6 种可能的请求顺序，其中哪些请求顺序能保证无死锁产生？请写出解题分析过程。

**答：**A 请求顺序为 1 2 3，B 请求顺序可能为：

1. 1 2 3（不会死锁）
2. 1 3 2（不会死锁）
3. 2 1 3（死锁）
4. 2 3 1（死锁）
5. 3 1 2（死锁）
6. 3 2 1（死锁）

分析可知，只有情况 1、2 不会死锁，因为 AB 一开始请求同个资源 1，只会有一个进程获得资源并运行，另一个被阻塞，知道一个进程运行结束释放所有资源后再运行，而其他四种情况一开始请求的是不同资源，导致两个进程都持有资源并会请求别人的资源，造成死锁。